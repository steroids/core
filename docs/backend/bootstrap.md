# Загрузка и инициализация приложения

Обычно загрузка Yii приложения выглядит так: подключаем `autoload.php`, загружаем конфиг, создаем экземпляр приложения
(консольного или веб) и вызываем у него метод `run()`. В Steroids эта логика вынесена в `boot/bootstrap.php` файл,
чтобы не дублировать код от проекта к проекту. В итоге для веб приложения файл `public/index.php` будет выглядеть так:

```php
<?php

require dirname(__DIR__) . '/vendor/steroids/core/boot/bootstrap.php';
```

А для консольного файл `yii` будет таким:

```sh
#!/usr/bin/env php
<?php

require __DIR__ . '/vendor/steroids/core/boot/bootstrap.php';
```

Для кастомизации логики файл `bootstrap.php` выносится в корень проекта и изменяется под свои нужды.


## Загрузка модулей и компонентов

В Steroids при добавлении в проект модуля не нужно отдельно прописывать его в конфигурации, достаточно разместить папку
модуля с файлом `*Module.php` в ней. Фреймворк каждый каз сканирует директорию на наличие модулей, в том числе сложенных.

Если модуль или компонент наследует `\yii\base\BootstrapInterface`, то он автоматически будет добавлен в `bootstrap`
секцию конфигурации Yii2 приложения.


## Безопасная загрузка конфигов

Конфиг в PHP - обычный массив, возвращаемый через `return`. И обычно его просто подгружают через `require 'config.php'`.

Так делали и мы до тех пор, пока однажды на продакшене, редактируя кастомный конфиг, случайно не добавился лишний символ
перед `<?php`. Просто символ, просто промазали по кнопке, но теперь это стал не `php` файл и все содержимое вывалилось
"наружу" (как через echo) пользователю при обращении к приложению. Последствий небыло, проблему быстро заметили и
пароли поменяли, но осадок остался.

Поэтому теперь при загрузке конфигов всегда используется `\steroids\core\boot\Boot::safeLoadConfig()` метод, который
проверяет существование файла и включает буферизацию вывода, для предотвращения его случайного отображения.